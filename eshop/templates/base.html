<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% include 'base/css.html' %}
    {% block head %}
    {% endblock %}
    <title>{% block title %}Hello, world!{%endblock%}</title>
  </head>
  <body>
    {% include 'base/navbar.html'%}
    <div class="container">
      {% block content %}{% endblock %}
    </div>
    <script>
      function myFunction() {
          console.log(x.value);
          var x = document.getElementById("myInput");
          document.getElementById("demo").innerHTML = x.value;
          console.log();
      }
    </script>
    {% include 'base/js.html' %}
    <script type="text/javascript">
        $(document).ready(function () {
            var $productForm = $('.form-product-ajax')
            $productForm.submit(function (e) {
                e.preventDefault();
                console.log("Form is not submitting")
                var $thisForm = $(this)
                var $httpMethod      = $(this).attr("method");
                var $endpointAction  = $(this).attr("action");
                var $formData        = $(this).serialize();

                $.ajax({
                    url: $endpointAction,
                    method: $httpMethod,
                    data: $formData,
                    success: function(data){
                        var $submitData = $thisForm.find(".submit_span")
                        if(data.added){
                            $submitData.html("<button type=\"submit\" class=\"btn btn-link\" style=\"padding:0\">Remove?</button>")
                        }else {
                            $submitData.html("<button type=\"submit\" class=\"btn btn-success\">Add</button>")
                        }
                        var $cartItemCount = $(".itemCount")
                        $cartItemCount.text(data.itemCount)

                    },
                    error: function (errorData) {
                        console.log("error")
                        console.log(errorData)
                    }

                })
            })
        })
    </script>
  </body>
</html>